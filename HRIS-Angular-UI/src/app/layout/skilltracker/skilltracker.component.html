<div class="reports-section" [@routerTransition]>
    <h6 class="text-muted-header"> Skill Tracker </h6>
    <div class="horizontal-pipe-line"></div>
    <div class="tabs-details-container">
        <div class="tabs-list">
            <ngb-tabset>
                <ngb-tab>
                    <ng-template ngbTabTitle> Skill Tracker</ng-template> 
                    <ng-template ngbTabContent>
                        <div class="nav-link-column" >
                            <div class="nav-link-actions">
                                <div class="nav-link-box">
                                        <!-- Drop Down for Quarter -->
                                        <div class="row">
                                            <div class="col-12 col-sm-6 col-md-3">
                                                <label class="field-label">Evaluation  Quarter</label>
                                                <select class="form-control" (change)="onQuarterChange($event.target.value)">
                                                    <option *ngFor="let quarter of evaluationQrtr" value={{quarter}}>
                                                        {{quarter}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- PRIMARY SKILLS FORM/TABLE -->
                                        <div class="row">
                                            <!-- Primary Skill Table -->
                                            <div class="col-12 mt-3">
                                                <h5 class="aa-form-group-header">Resoursing Skill Set</h5>
                                                <table style="width:100%">
                                                    <thead>
                                                        <th>SL No</th>
                                                        <th>Skills</th>
                                                        <th>Matrix Score</th>
                                                        <th>Logivity Score</th>
                                                        <th>Experience Score</th>
                                                        <th>Skill Score</th>
                                                        <th>Evaluation</th>
                                                        <th>Last Evaluated On</th>
                                                    </thead>
                                                    <tbody>
                                                        <!-- THESE ROWS WILL BE CREATED FOR CURRENT QUARTER -->
                                                        <ng-container *ngIf="isCurrentQtr">
                                                            <tr *ngFor="let skills of skillDetails; let i = index">
                                                                <td> <span>{{i+1}}</span> </td>
                                                                <td> <span>{{skills.s_name}}</span> </td>
                                                                <td> 
                                                                    <select (change)="calculateSkillScore(i)" class="form-control" [(ngModel)]="skillDetails[i].matrix_score">
                                                                        <option>Select score</option>
                                                                        <option *ngFor="let matrix of matrixScoreOption" value={{matrix.id}} [selected]="skills.matrix_score == matrix.id">
                                                                            {{matrix.name}}
                                                                        </option>
                                                                    </select>
                                                                </td>
                                                                <td>
                                                                    <select (change)="calculateSkillScore(i)" class="form-control" [(ngModel)]="skillDetails[i].longivity_score">
                                                                        <!-- <option>Select score</option> -->
                                                                        <option *ngFor="let longivity of longivityScoreOption" value={{longivity.id}} [selected]="skills.longivity_score == longivity.id">
                                                                            {{longivity.name}}
                                                                        </option>
                                                                    </select>
                                                                </td>
                                                                <td>
                                                                    <select (change)="calculateSkillScore(i)" class="form-control" [(ngModel)]="skillDetails[i].experience_score">
                                                                        <!-- <option>Select score</option> -->
                                                                        <option *ngFor="let exp of experienceScoreOption" value={{exp.id}} [selected]="skills.experience_score == exp.id">
                                                                            {{exp.name}}
                                                                        </option>
                                                                    </select>
                                                                </td>
                                                                <td> <span>{{skills.skill_score | number: '1.2-2' }}</span> </td>
                                                                <td> <span>{{skills.evaluated?'Yes':'No'}}</span> </td>
                                                                <td> <span>{{skills.evaluated_on}}</span> </td>
                                                            </tr>
                                                        </ng-container>

                                                        <!-- THESE ROWS WILL BE CREATED FOR HISTORY QUARTER -->
                                                        <ng-container *ngIf="!isCurrentQtr">
                                                            <tr *ngFor="let skills of skillDetails; let i = index">
                                                                <td> <span>{{i+1}}</span> </td>
                                                                <td> <span>{{skills.s_name}}</span> </td>
                                                                <td> <span>{{skills.matrix_score}}</span></td>
                                                                <td> <span>{{skills.longivity_score}}</span></td>
                                                                <td> <span>{{skills.experience_score}}</span></td>
                                                                <td> <span>{{skills.skill_score | number: '1.2-2' }}</span> </td>
                                                                <td> <span>{{skills.evaluated?'Yes':'No'}}</span> </td>
                                                                <td> <span>{{skills.evaluated_on}}</span> </td>
                                                            </tr>
                                                        </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- Primary Skill Buttons -->
                                            <div class="col-12 mt-3 text-center" *ngIf="isCurrentQtr">
                                                <button type="button" class="btn btn-success" (click)="onSubmit(1)">Submit</button>
                                            </div>
                                        </div>


                                        <!-- Horizon3 Skill Add -->
                                        <div class="row mt-3" *ngIf="isHorizonSkills">
                                            <div class="col-12">
                                                <h5 class="aa-form-group-header"> Horizon Skill Set
                                                    <button type="button" class="btn btn-primary btn-sm" (click)="openModalDialog()">Add Skills</button>
                                                </h5>
                                                <div class="backdrop" [ngStyle]="{'display':display}"></div>
                                            </div>
                                        </div>
                                        <!-- Horizon3 Skill Table -->
                                        <div class="row">
                                            <div class="col-12 mt-3" *ngIf="horizonSkillDetails.length > 0">
                                                <table style="width:100%">
                                                    <thead>
                                                        <th>Sl No</th>
                                                        <th>Skills</th>
                                                        <th>Skill Score</th>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let second of horizonSkillDetails; let i = index">
                                                            <td>{{i+1}}</td>
                                                            <td>
                                                            {{second.s_name}}
                                                            </td>
                                                            <td>
                                                                <select (change)="addHorizonSkills($event.target.value, i)" class="form-control">
                                                                    <option>Select</option>
                                                                    <option *ngFor="let eva of horizonSkillScoreOption" value={{eva.id}}>
                                                                        {{eva.value}}
                                                                    </option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- Horizon3 Skill Buttons -->
                                            <div class="col-12 mt-3 text-center" *ngIf="submittedData && horizonSkillDetails.length > 0">
                                                <button type="button" class="btn btn-success" (click)="onSubmit(2)">Submit</button>
                                            </div>
                                        </div>

                                </div>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>
                <ngb-tab *ngIf="role==1">
                        <ng-template ngbTabTitle> <span (click)="prepareApprovalTab()">Approval</span></ng-template> 
                        <ng-template ngbTabContent>
                            <div class="nav-link-column" >
                                <div class="nav-link-actions">
                                    <div class="nav-link-box">
                                            <!-- Drop Down for Quarters & Employee -->
                                            <div class="row">
                                                <div class="col-12 col-sm-4 col-md-3">
                                                    <label class="field-label">Evaluation  Quarter</label>
                                                    <select class="form-control" [(ngModel)]="approvalQtr" >
                                                        <option *ngFor="let quarter of evaluationQrtr" value={{quarter}}>
                                                            {{quarter}}
                                                        </option>
                                                    </select>
                                                </div>
                                                <div class="col-12 col-sm-4 col-md-3">
                                                    <label class="field-label">Employee</label>
                                                    <select class="form-control" [(ngModel)]="approvalEmployeeId">
                                                        <option value="0">Select Employee ID</option>
                                                        <option *ngFor="let emp of employeeList" value={{emp.Employee_Id}}>
                                                            {{emp.Employee_Id}} - {{emp.Employee_Name}}
                                                        </option>
                                                    </select>
                                                </div>
                                                <div class="col-12 col-sm-4 col-md-3">
                                                    <br>
                                                    <button type="button" class="btn btn-primary" (click)="getApprovalData()">Show</button>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <!-- Primary Skill Table -->
                                                <div class="col-12 mt-3">
                                                   <h5 class="aa-form-group-header">Resoursing Skill Set</h5>
                                                    <table style="width:100%">
                                                        <thead>
                                                            <th>SL No</th>
                                                            <th>Skills</th>
                                                            <th>Matrix Score</th>
                                                            <th>Logivity Score</th>
                                                            <th>Experience Score</th>
                                                            <th>Skill Score</th>
                                                            <th>Evaluation</th>
                                                            <th>Evaluated By</th>
                                                            <th>Last Evaluated On</th>
                                                        </thead>
                                                        <tbody>
                                                            <ng-container *ngIf="isApprovalCurrentQtr">
                                                                <tr *ngFor="let skills of approvalSkillDetails; let i = index">
                                                                    <td> <span>{{i+1}}</span> </td>
                                                                    <td> <span>{{skills.s_name}}</span> </td>
                                                                    <td> 
                                                                        <select (change)="calculateApprovalSkillScore(i)" class="form-control" [(ngModel)]="approvalSkillDetails[i].matrix_score">
                                                                            <!-- <option>Select score</option> -->
                                                                            <option *ngFor="let matrix of matrixScoreOption" value={{matrix.id}} [selected]="skills.matrix_score == matrix.id">
                                                                                {{matrix.name}}
                                                                            </option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select (change)="calculateApprovalSkillScore(i)" class="form-control" [(ngModel)]="approvalSkillDetails[i].longivity_score">
                                                                            <!-- <option>Select score</option> -->
                                                                            <option *ngFor="let longivity of longivityScoreOption" value={{longivity.id}} [selected]="skills.longivity_score == longivity.id">
                                                                                {{longivity.name}}
                                                                            </option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select (change)="calculateApprovalSkillScore(i)" class="form-control" [(ngModel)]="approvalSkillDetails[i].experience_score">
                                                                            <!-- <option>Select score</option> -->
                                                                            <option *ngFor="let exp of experienceScoreOption" value={{exp.id}} [selected]="skills.experience_score == exp.id">
                                                                                {{exp.name}}
                                                                            </option>
                                                                        </select>
                                                                    </td>
                                                                    <td> <span>{{skills.skill_score | number: '1.2-2' }}</span> </td>
                                                                    <td>
                                                                        <select class="form-control" [(ngModel)]="approvalSkillDetails[i].evaluated">
                                                                            <!-- <option>Select score</option> -->
                                                                            <option *ngFor="let eval of evaluationStatusOption" value={{eval.id}} [selected]="skills.evaluated == eval.id">
                                                                                {{eval.name}}
                                                                            </option>
                                                                        </select>
                                                                    </td>
                                                                    <td> <span>{{skills.manager_name }}</span> </td>
                                                                    <td> <span>{{skills.evaluated_on }}</span> </td>
                                                                </tr>
                                                            </ng-container>

                                                            <!-- THESE ROWS WILL BE CREATED FOR HISTORY QUARTER -->
                                                            <ng-container *ngIf="!isApprovalCurrentQtr">
                                                                <tr *ngFor="let skills of approvalSkillDetails; let i = index">
                                                                    <td> <span>{{i+1}}</span> </td>
                                                                    <td> <span>{{skills.s_name}}</span> </td>
                                                                    <td> <span>{{skills.matrix_score}}</span></td>
                                                                    <td> <span>{{skills.longivity_score}}</span></td>
                                                                    <td> <span>{{skills.experience_score}}</span></td>
                                                                    <td> <span>{{skills.skill_score | number: '1.2-2' }}</span> </td>
                                                                    <td> <span>{{skills.evaluated?'Yes':'No'}}</span> </td>
                                                                    <td> <span>{{skills.manager_name }}</span> </td>
                                                                    <td> <span>{{skills.evaluated_on}}</span> </td>
                                                                </tr>
                                                            </ng-container>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Primary Skill Approve Button  -->
                                                <div class="col-12 mt-3 text-center" *ngIf="isApprovalCurrentQtr">
                                                    <button type="button" class="btn btn-success" (click)="saveApprovalData(1)">Submit</button>
                                                </div>
                                            </div>

                                            <!-- Horizon3 Skill Table -->
                                            <div class="row mt-3" *ngIf="isHorizonSkills">
                                                <h5 class="aa-form-group-header"> Horizon Skill Set </h5>
                                                <table style="width:100%">
                                                    <thead>
                                                        <th>Sl No</th>
                                                        <th>Skills</th>
                                                        <th>Select</th>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let second of EvaluatedData; let i = index">
                                                            <td>{{i+1}}</td>
                                                            <td>
                                                            {{second}}
                                                            </td>
                                                            <td>
                                                                <select (change)="filterForeCasts($event.target.value)" class="form-control">
                                                                    <option>Select</option>
                                                                    <option *ngFor="let eva of Evaluated" value={{eva.id}}>
                                                                        {{eva.value}}
                                                                    </option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="row mt-3">
                                                <div class="col col-md-12" style="text-align: center;">
                                                    <button type="button" class="btn btn-success">Approve</button>
                                                </div>
                                            </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                </ngb-tab>
            </ngb-tabset>
        </div>
    </div>
</div>

<!-- After clicking the button open the modal dialog using open/close event binding methods -->
<!-- <button type="button" class="btn btn-info btn-lg" (click)="closeModalDialog()">Open Login Modal Dialog!</button>
<div class="backdrop" [ngStyle]="{'display':display}"></div> -->

<!-- modal -->
<div class="modal" tabindex="-1" role="dialog"  [ngStyle]="{'display':display}">
  <!-- modal-dialog -->
  <div class="modal-dialog" role="document">
    <!-- modal-content -->
    <div class="modal-content">
      <!-- modal-header -->
      <div class="modal-header">
        <h6 class="modal-title">Choose Horizon3 Skill</h6>
        <button type="button" class="close" aria-label="Close" (click)="closeModalDialog()"><span aria-hidden="true">&times;</span></button>
        <!-- <h4 class="modal-title">Login</h4> -->
      </div>

      <!-- modal-body -->
      <div class="modal-body">
        <form #secondaryskillform = "ngForm">
            <div class="row">
                <div class="col-12 col-sm-6" *ngFor="let skills of secondarySkillDetails; let i = index">
                    <input type="checkbox" class="form-control-inline" (change)="changeHorizonBox(skills.checked,i)" [(ngModel)]="skills.checked" [ngModelOptions]="{standalone: true}">&nbsp;{{skills.s_name}} 
                </div>
            </div>
         </form>
      </div>
    </div>
  </div>
</div>